<!DOCTYPE html >

<html >
  <head >
    <title >ultimate tic-tac-toe</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" ></script>
    <link rel="stylesheet" type="text/css" href="/static/res/css/game.css" />
  </head>
  <body >
    <div class="player" >

    </div>
    <div class='global' >
      <div class='local' data-local="0" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="1" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="2" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="3" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="4" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="5" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="6" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="7" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>
      <div class='local' data-local="8" >
        <div class='cell' data-cell="0" ></div>
        <div class='cell' data-cell="1" ></div>
        <div class='cell' data-cell="2" ></div>
        <div class='cell' data-cell="3" ></div>
        <div class='cell' data-cell="4" ></div>
        <div class='cell' data-cell="5" ></div>
        <div class='cell' data-cell="6" ></div>
        <div class='cell' data-cell="7" ></div>
        <div class='cell' data-cell="8" ></div>
      </div>

    </div>
    <script >

      var getParameterByName = function(name) {
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(window.location.href);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
      }

      $('.player').text(getParameterByName('player'))

      $('.cell').click(function(e) {
        e.preventDefault()

        var local = $(this).parent().data('local')
        var cell = $(this).data('cell')

        $.ajax({
          url: 'http://localhost:8080/api/game/move',
          type: 'post',
          data: {
            game_name: getParameterByName('game_name'),
            player: getParameterByName('player'),
            local: local,
            cell: cell
          },
          success: function(data) {
            console.log(data)
          }
        })
      })


      //
      // var updateBoard = function() {
      //
      //   if (sessionStorage.getItem('log_id') == null) {
      //     sessionStorage.setItem('log_id', 0)
      //   }
      //
      //   $.ajax({
      //     url: 'http://localhost:8080/api/game/update',
      //     type: 'post',
      //     data: {
      //       game_name: getParameterByName('game_name'),
      //       log_id: sessionStorage.getItem('log_id')
      //     },
      //     success: function(data) {
      //       if (data.status == 200) {
      //         console.log(data.payload)
      //         sessionStorage.setItem('log_id', data.payload.log_id)
      //       } else if (data.status != 204) {
      //         alert(data.payload.message)
      //       } else {
      //         console.log(data)
      //       }
      //     }
      //   })
      // }
      //
      // setInterval(updateBoard, 1000)

    </script>
  </body>
</html>
